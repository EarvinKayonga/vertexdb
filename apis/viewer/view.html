<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>view</title>
		<script type="text/javascript" charset="utf-8" src="http://ajax.googleapis.com/ajax/libs/mootools/1.2.4/mootools-yui-compressed.js"></script>
	</head>
	
	<body>
		<div id="node_/">
			
		</div>
		
		<style type="text/css" media="screen">
			div {
				font-size: 14px;
				line-height: 14px;
				margin: 4px 0;
  			margin-left: 25px;
  			padding-bottom: 3px;
			}
			
			a {
			  margin-left: 10px;
			  font-size: 13px;
			  color: #33d;
			}
			
			i, b {
			  margin-right: 10px;
			}
			
			b {
			  color: #444;
			}
			
			small {
			  color: #444;
			}
			
		</style>
	</body>
	<script type="text/javascript" charset="utf-8">
		window.addEvent('domready', function () {
			loadContent('/');
		});
		
		function loadContent(path) {
			node = $('node_' + path);
			
			// closing if loaded
			if (node.loaded) {
			  node.getElements('div').destroy();
			  node.getElement('a').set('text', 'load');
			  node.loaded = false;
			  return;
			}
			
			new Request.JSON({url: '/select', onSuccess: function(result){
				$each(result, function(val, key) {
					
					
					if (key[0] == '_') {
  					var row = new Element('div', {html: '<i>' + key + '</i> <span>' + val + '</span>', id: 'node_' + path + key + '/'}).inject(node);
				  } else {
  					var row = new Element('div', {html: '<b>' + key + '</b> <small>(' + val + ')</small>', id: 'node_' + path + key + '/'}).inject(node);
  					var a = new Element('a', {'text': 'load'}).inject(row);
  					a.addEvent('click', function () {
  						loadContent(path + key + '/');
  					});
					}
					
					node.loaded = true;
					if (path != '/') {
					  node.getElement('a').set('text', 'close');
				  }
				});
			}}).get({'path': path, 'op': 'object'});
		}
	</script>
</html>